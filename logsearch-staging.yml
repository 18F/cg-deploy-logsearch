instance_groups:
- name: elasticsearch_master
  instances: 3
  networks:
  - name: logsearch
    static_ips:
    - (( grab terraform_outputs.logsearch_static_ips.[0]))
    - (( grab terraform_outputs.logsearch_static_ips.[4]))
    - (( grab terraform_outputs.logsearch_static_ips.[6]))

- name: ingestor
  instances: 1
  networks:
  - name: logsearch
    static_ips:
    - (( grab terraform_outputs.logsearch_static_ips.[1] ))
  properties:
    cloudfoundry:
      api_endpoint: api.fr-stage.cloud.gov

- name: ls-router
  jobs:
  - name: route_registrar
    properties:
      route_registrar:
        routes:
        - name: logsearch
          port: 80
          registration_interval: 20s
          uris:
          - logs.fr-stage.cloud.gov

- name: kibana
  jobs:
  - name: kibana
    properties:
      kibana:
        env:
        - (( append ))
        - CF_API_URI: https://api.fr-stage.cloud.gov
